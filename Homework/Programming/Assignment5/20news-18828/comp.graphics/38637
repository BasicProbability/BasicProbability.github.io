From rytg7feltnonl Q van Rijt
Subject Re Sphere from 4 points

There is another useful method based on Least Sqyares Estimation of the sphere equation parameters

The points xyz on a spherical surface with radius R and center abc can be written as 

   xa2  yb2  zc2  R2

This equation can be rewritten into the following form  

   2ax  2by  2cz  R2  a2  b2 c2  x2  y2  z2

Approximate the left hand part by   Fxyz  p1x  p2x  p3z  p41

For all datapoints ic 4 determine the 4 parameters p1p4 which minimise the average error Fxyz  x2  y2  z22

In Numerical Recipes in C can be found algorithms to solve these parameters

The best fitting sphere will have 
 center abc  p12 p22 p32
 radius R  sqrtp4  aa  bb  cc

So at last will this solve you sphere estination problem at least for the most situations I think 

Quick van Rijt rytg7feltnonl



