From stolkfwiuvanl Bram
Subject Creating 8 bit windows on 24 bit display How

Greetings


I am using an X server that provides 3 visuals
PseudoColor 8 bit Truecolor 24 bit and DirectColor 24 bit

A problem occurs when I try to create a window with a visual that is different
from the visual of the parent which uses the default visual which is TC24

In the Xlib reference guide from O reilly one can read in the
section about XCteateWindow something like
In the current implementation of X11 When using a visual other than the
parents be sure to create or find a suitable colourmap which is to be used 
in the window attributes when creating or else a BadMatch occurs

This warning strangely enough is only mentioned in the newer editions
of the X11R5 guides

However even if I pass along a suitable colourmap I still get a BadMatch
when I create a window with a nondefault visual
The code looks like this

 cut here and youll destroy your CRT 

Window create8bitwindowontruecolourdisplaydpywidthheight
Display dpy
int width height

  Window win
  XVisualInfo vinfo
  XSetWindowAttributes attr

  fprintfstderrOpening 8 bit windown
  if XMatchVisualInfodpyDefaultScreendpy8PseudoColorvinfo 
    fprintfstderrYour display cant handle 8 bit PseudoColorn
    exit1
  
  fprintfstderrUsing visual xnvinfovisualvisualid
  cmap  XCreateColormap
           dpy
           DefaultRootWindowdpy
           vinfovisual
           AllocNone
         
  XSyncdpyFalse
  XInstallColormapdpycmap	 ommision of this line gives same result 
  attrcolormap  cmap
  win  XCreateWindow
          dpy
          DefaultRootWindowdpy
          1010
          widthheight
          CopyFromParent        border width 
          8                     depth 
          InputOutput           class 
          vinfovisual          visual 
          CWColormap
          attr
        
  return win


 cut here and youll destroy your CRT 

Executing this piece of code results in a BadMatch error
Anybody who knows why
If so please drop me a line



	Take care


		Bram Stolk
		stolkfwiuvanl
