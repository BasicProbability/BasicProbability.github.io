From mousethundermcrcimmcgilledu der Mouse
Subject Re Creating 8 bit windows on 24 bit display How

In article 1993Apr1609320925719fwiuvanl stolkfwiuvanl Bram writes

 I am using an X server that provides 3 visuals PseudoColor 8 bit
 Truecolor 24 bit and DirectColor 24 bit

Lucky dog 

 A problem occurs when I try to create a window with a visual that is
 different from the visual of the parent which uses the default
 visual which is TC24

 In the Xlib reference guide from O reilly one can read in the
 section about XCteateWindow something like
     In the current implementation of X11 When using a visual other
     than the parents be sure to create or find a suitable colourmap
     which is to be used in the window attributes when creating or
     else a BadMatch occurs

 This warning strangely enough is only mentioned in the newer
 editions of the X11R5 guides

It applies with equal force to earlier versions  Presumably only
recently did the authors decide it was important enough to mention
The necessity it refers to has always been there but its been
implicit in the way CreateWindow requests default some attributes of
the new window

 However even if I pass along a suitable colourmap I still get a
 BadMatch when I create a window with a nondefault visual

   attrcolormap  cmap
   win  XCreateWindow

           CopyFromParent        border width 
           8                     depth 
           InputOutput           class 
           vinfovisual          visual 
           CWColormap
           attr
         

This is because the warning you read is incomplete  You have to
provide not only a colormap but also a border  The default border is
CopyFromParent which is not valid when the windows depth doesnt
match its parents  Specify a borderpixmap of the correct depth or a
borderpixel and the problem should go away

There is another problem I cant find anything to indicate that
CopyFromParent makes any sense as the borderwidth parameter to
XCreateWindow  Your Xlib implementation probably defines
CopyFromParent as zero to simplify the conversion to wire format so
you are unwittingly asking for a border width of zero due to the Xlib
implementation not providing stricter typechecking  To be fair Im
not entirely certain its possible for Xlib to catch this

					der Mouse

				mousemcrcimmcgilledu
