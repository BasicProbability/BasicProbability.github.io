From yangcsumassedu Hong Yang
Subject colormap question

Hi Experts 

Im kind of new to X The following question is strange to me I am
trying to modify the contents of the colormap but failed without
reason to me I am using the following piece of code


  toplevel  XtInitializeargv0 Testcolor NULL 0
			  argc argv
  dpy  XtDisplaytoplevel
  scr  DefaultScreendpy
  defcolormap  DefaultColormapdpyscr

  ifXAllocColorCellsdpy defcolormap True NULL 0 cells 5 
    colorpixel  cells0
    colorred  250
    colorgreen  125
    colorblue  0
    colorflags  DoRed  DoGreen  DoBlue
    XStoreColordpy defcolormap color
    printfn Try to allocate the color d as ddd
	   colorpixel colorred colorgreen colorblue 

    XQueryColordpy defcolormap color
    printfn After  allocate the color d is ddd
	   colorpixel colorred colorgreen colorblue 
  
  else
    printfn Error couldnt allocate color cells


Running output

     Try to allocate the color 7 as 2501250
     After  allocate the color 7 is 000

After XStoreColor XQueryColor just returned the original value 
No failureerror displayed but the contents of colormap are obvious
unchanged I also tried to draw a line using the colors but it 
turned out to be the unmodified colors

So what is my problem How to modify the contents of the colormap

Any helpinformation will be appreciated Please send mail to
yangcsumassedu


William 
email yangcsumassedu



By the way the following is the environment I am using output of
xdpyinfo It shows the default visual is PseudoColor

version number    110
vendor string    DECWINDOWS DigitalEquipmentCorporation UWS42
vendor release number    1
maximum request size  16384 longwords 65536 bytes
motion buffer size  100
bitmap unit bit order padding    32 LSBFirst 32
image byte order    LSBFirst
number of supported pixmap formats    2
supported pixmap formats
    depth 1 bitsperpixel 1 scanlinepad 32
    depth 8 bitsperpixel 8 scanlinepad 32
keycode range    minimum 86 maximum 251
number of extensions    8
    AdobeDPSExtension
    DPSExtension
    SHAPE
    MITSHM
    MultiBuffering
    XInputExtension
    MITSUNDRYNONSTANDARD
    DECXTRAP
default screen number    0
number of screens    1

screen 0
  dimensions    1024x864 pixels 333x281 millimeters
  resolution    78x78 dots per inch
  depths 2    1 8
  root window id    0x29
  depth of root window    8 planes
  number of colormaps    minimum 1 maximum 1
  default colormap    0x27
  default number of colormap cells    256
  preallocated pixels    black 1 white 0
  options    backingstore YES saveunders YES
  current input event mask    0xd0001d
    KeyPressMask             ButtonPressMask          ButtonReleaseMask        
    EnterWindowMask          SubstructureRedirectMask PropertyChangeMask       
    ColormapChangeMask       
  number of visuals    5
  default visual id  0x21
  visual
    visual id    0x21
    class    PseudoColor
    depth    8 planes
    size of colormap    256 entries
    red green blue masks    0x0 0x0 0x0
    significant bits in color specification    8 bits
  visual
    visual id    0x22
    class    GrayScale
    depth    8 planes
    size of colormap    256 entries
    red green blue masks    0x0 0x0 0x0
    significant bits in color specification    8 bits
  visual
    visual id    0x23
    class    StaticGray
    depth    8 planes
    size of colormap    256 entries
    red green blue masks    0x0 0x0 0x0
    significant bits in color specification    8 bits
  visual
    visual id    0x24
    class    StaticColor
    depth    8 planes
    size of colormap    256 entries
    red green blue masks    0x7 0x38 0xc0
    significant bits in color specification    8 bits
  visual
    visual id    0x25
    class    TrueColor
    depth    8 planes
    size of colormap    8 entries
    red green blue masks    0x7 0x38 0xc0
    significant bits in color specification    8 bits
  number of mono multibuffer types    5
    visual id max buffers depth    0x21 0 8
    visual id max buffers depth    0x22 0 8
    visual id max buffers depth    0x23 0 8
    visual id max buffers depth    0x24 0 8
    visual id max buffers depth    0x25 0 8
  number of stereo multibuffer types    0

