From sinclairdcsglasgowacuk Duncan Sinclair
Subject Glasgow RX  remote execution of X programs Part0101

 I posted this a few weeks back but all I got back was an error
   message pnews devnull Permission denied  Yep devnull
   had a mode of 600  Arrghhh  

With renewed interest in setting the DISPLAY variable etc I
thought I would post my contribution

This Perl script is my solution  It trys to be intelligent about
what its doing so that you should be able to type rx hostdomainetc
and get a xterm running on hostdomainetc with all the difficult
stuff taken care of

In theory this program can do everything you ever wanted to do
when you wanted to run a remote command in the background  it
doesnt even need to be an X program  Try a rx bigmachine make
for instance for a backgrounded make on the remote bigmachine

For more details and a full list of features read the README file
about 20 lines below  All comments welcome

Duncan



 binsh
 This is a shell archive  Remove anything before this line then unpack
 it by saving it into a file and typing sh file  To overwrite existing
 files type sh file c  You can also feed this as standard input via
 unshar or by typing sh file eg  If this archive is complete you
 will see the following message at the end
		End of archive 1 of 1
 Contents  README Imakefile MANIFEST Makefile rxman rxpl
 Wrapped by sinclairdcsglaacuk on Thu Apr  8 184748 1993
PATHbinusrbinusrucb  export PATH
if test f README a 1  c  then 
  echo shar Will not clobber existing file README
else
echo shar Extracting README 1442 characters
sed sX README ENDOFFILE
X
X   Glasgow RX  remote execution of X programs  Version 317
X
XCopyright 1992 Duncan Sinclair sinclairdcsglaacuk
X
XTrivial to install but theres an Imakefile to make it even more trivial
X
XThe perl script needs some customisation before it is installed just
Xedit the rxpl file and read the comments  Once youve done
Xthis you can xmkmf then make install installman
X
XFEATURES
X
X Does the right thing for offsite remote execution  Including
X   setting up DISPLAY to include domain names and passing
X   magic cookies or doing the xhost stuff
X
X Allow different remote user name  rx l user host 
X
X Smart quoting of arguments  makes passing wildcards easy
X
X Custom command execution  link it to remacs to get a remote
X   emacs command
X
X Automatic xterm options  names the xterm according to hostname
X   and turns on login shell
X
X Default command is xterm
X
X Propagates Xish env variables to remote session  user may
X   extend the list of variables to pass
X
X Special handling for bourne shell users
X
X Tries to do remote execution from same directory as local
X   That is it propagates PWD in an intelligent manner
X
X Logs errors in a file
X
X Overall Intelligence TM  makes reasoned decisions about what
X   you are trying to do and tries to do the right thing
X
X Written in Perl for portability and hackability
X
XFor more info read the man page or the source
X
ENDOFFILE
if test 1442 ne wc c README then
    echo shar README unpacked with wrong size
fi
 end of README
fi
if test f Imakefile a 1  c  then 
  echo shar Will not clobber existing file Imakefile
else
echo shar Extracting Imakefile 370 characters
sed sX Imakefile ENDOFFILE
X Glasgow RX Imakefile
X
X         PROGRAMS  rx
X
Xall PROGRAMS
X
Xinstall safe
X
XInstallNamedProgrxplrxBINDIR
XInstallManPagerxMANDIR
X
Xinstall
X	RM BINDIRrxterm
X	LN BINDIRrx BINDIRrxterm
X
Xsafe
X	grep s debug  0 rxpl  false
X
Xshar safe
X	makekit m p
X	perl pi e ssinclairdcsglaacuksinclairdcsglaacuk Part
X
ENDOFFILE
if test 370 ne wc c Imakefile then
    echo shar Imakefile unpacked with wrong size
fi
 end of Imakefile
fi
if test f MANIFEST a 1  c  then 
  echo shar Will not clobber existing file MANIFEST
else
echo shar Extracting MANIFEST 313 characters
sed sX MANIFEST ENDOFFILE
X   File Name		Archive 	Description
X
X README                     1	Read me first
X Imakefile                  1	
X MANIFEST                   1	This shipping list
X Makefile                   1	
X rxman                     1	
X rxpl                      1	
ENDOFFILE
if test 313 ne wc c MANIFEST then
    echo shar MANIFEST unpacked with wrong size
fi
 end of MANIFEST
fi
if test f Makefile a 1  c  then 
  echo shar Will not clobber existing file Makefile
else
echo shar Extracting Makefile 10172 characters
sed sX Makefile ENDOFFILE
X Makefile generated by imake  do not edit
X XConsortium imakecv 165 910725 175017 rws Exp 
X
X The cpp used on this machine replaces all newlines and multiple tabs and
X spaces in a macro expansion with a single space  Imake tries to compensate
X for this but is not always successful
X
X
X 
X Makefile generated from Imaketmpl and tmpIIfa04196
X XConsortium Imaketmplv 1139 910916 085248 rws Exp 
X
X Platformspecific parameters may be set in the appropriate vendorcf
X configuration files  Sitespecific parameters should be set in the file
X sitedef  Full rebuilds are recommended if any parameters are changed
X
X If your C preprocessor does not define any unique symbols you will need
X to set BOOTSTRAPCFLAGS when rebuilding imake usually when doing
X make World the first time
X
X
X 
X sitespecific configuration parameters that need to come before
X the platformspecific parameters  edit sitedef to change
X
X site  XConsortium sitedefv 12 910730 202644 rws Exp 
X
X 
X platformspecific configuration parameters  edit suncf to change
X
X platform  XConsortium suncfv 17211 920318 131337 rws Exp 
X
X operating system  SunOS 413
X
X XConsortium sunLibrulesv 17 911220 111947 rws Exp 
X
X 
X sitespecific configuration parameters that go after
X the platformspecific parameters  edit sitedef to change
X
X site  XConsortium sitedefv 12 910730 202644 rws Exp 
X
X            SHELL  binsh
X
X              TOP  
X      CURRENTDIR  
X
X               AR  ar cq
X  BOOTSTRAPCFLAGS 
X               CC  gcc fpccstructreturn
X               AS  as
X
X         COMPRESS  compress
X              CPP  libcpp STDCPPDEFINES
X    PREPROCESSCMD  gcc fpccstructreturn E STDCPPDEFINES
X          INSTALL  install
X               LD  ld
X             LINT  lint
X      LINTLIBFLAG  C
X         LINTOPTS  axz
X               LN  ln s
X             MAKE  make
X               MV  mv
X               CP  cp
X
X           RANLIB  ranlib
X  RANLIBINSTFLAGS 
X
X               RM  rm f
X            TROFF  psroff
X         MSMACROS  ms
X              TBL  tbl
X              EQN  eqn
X     STDINCLUDES 
X  STDCPPDEFINES 
X      STDDEFINES 
X EXTRALOADFLAGS 
X  EXTRALIBRARIES 
X             TAGS  ctags
X
X    SHAREDCODEDEF  DSHAREDCODE
X         SHLIBDEF  DSUNSHLIB
X
X    PROTODEFINES 
X
X     INSTPGMFLAGS 
X
X     INSTBINFLAGS  m 0755
X     INSTUIDFLAGS  m 4755
X     INSTLIBFLAGS  m 0644
X     INSTINCFLAGS  m 0444
X     INSTMANFLAGS  m 0444
X     INSTDATFLAGS  m 0444
X    INSTKMEMFLAGS  g kmem m 2755
X
X      PROJECTROOT  usrX11
X
X     TOPINCLUDES  IINCROOT
X
X      CDEBUGFLAGS  O2
X        CCOPTIONS 
X
X      ALLINCLUDES  INCLUDES EXTRAINCLUDES TOPINCLUDES STDINCLUDES
X       ALLDEFINES  ALLINCLUDES STDDEFINES EXTRADEFINES PROTODEFINES DEFINES
X           CFLAGS  CDEBUGFLAGS CCOPTIONS ALLDEFINES
X        LINTFLAGS  LINTOPTS DLINT ALLDEFINES
X
X           LDLIBS  SYSLIBRARIES EXTRALIBRARIES
X
X        LDOPTIONS  CDEBUGFLAGS CCOPTIONS LOCALLDFLAGS LUSRLIBDIR
X
X   LDCOMBINEFLAGS  X r
X      DEPENDFLAGS 
X
X        MACROFILE  suncf
X           RMCMD  RM CKP ln BAK bak o core errs   a emacs tags TAGS makelog MakeOut
X
X    IMAKEDEFINES 
X
X         IRULESRC  CONFIGDIR
X        IMAKECMD  IMAKE DUseInstalled IIRULESRC IMAKEDEFINES
X
X     ICONFIGFILES  IRULESRCImaketmpl IRULESRCImakerules 
X			IRULESRCProjecttmpl IRULESRCsitedef 
X			IRULESRCMACROFILE EXTRAICONFIGFILES
X
X 
X X Window System Build Parameters
X XConsortium Projecttmplv 113811 921111 094919 rws Exp 
X
X 
X X Window System make variables this need to be coordinated with rules
X
X          PATHSEP  
X        USRLIBDIR  usrX11lib
X           BINDIR  usrX11localbin
X          INCROOT  usrX11include
X     BUILDINCROOT  TOP
X      BUILDINCDIR  BUILDINCROOTX11
X      BUILDINCTOP  
X           INCDIR  INCROOTX11
X           ADMDIR  usradm
X           LIBDIR  USRLIBDIRX11
X        CONFIGDIR  LIBDIRconfig
X       LINTLIBDIR  USRLIBDIRlint
X
X          FONTDIR  LIBDIRfonts
X         XINITDIR  LIBDIRxinit
X           XDMDIR  LIBDIRxdm
X           TWMDIR  LIBDIRtwm
X          MANPATH  usrX11man
X    MANSOURCEPATH  MANPATHman
X        MANSUFFIX  n
X     LIBMANSUFFIX  3
X           MANDIR  MANSOURCEPATHMANSUFFIX
X        LIBMANDIR  MANSOURCEPATHLIBMANSUFFIX
X           NLSDIR  LIBDIRnls
X        PEXAPIDIR  LIBDIRPEX
X      XAPPLOADDIR  LIBDIRappdefaults
X       FONTCFLAGS  t
X
X     INSTAPPFLAGS  INSTDATFLAGS
X
X            IMAKE  imake
X           DEPEND  makedepend
X              RGB  rgb
X
X            FONTC  bdftopcf
X
X        MKFONTDIR  mkfontdir
X        MKDIRHIER  binsh BINDIRmkdirhier
X
X        CONFIGSRC  TOPconfig
X       DOCUTILSRC  TOPdocutil
X        CLIENTSRC  TOPclients
X          DEMOSRC  TOPdemos
X           LIBSRC  TOPlib
X          FONTSRC  TOPfonts
X       INCLUDESRC  TOPX11
X        SERVERSRC  TOPserver
X          UTILSRC  TOPutil
X        SCRIPTSRC  UTILSRCscripts
X       EXAMPLESRC  TOPexamples
X       CONTRIBSRC  TOPcontrib
X           DOCSRC  TOPdoc
X           RGBSRC  TOPrgb
X        DEPENDSRC  UTILSRCmakedepend
X         IMAKESRC  CONFIGSRC
X         XAUTHSRC  LIBSRCXau
X          XLIBSRC  LIBSRCX
X           XMUSRC  LIBSRCXmu
X       TOOLKITSRC  LIBSRCXt
X       AWIDGETSRC  LIBSRCXaw
X       OLDXLIBSRC  LIBSRColdX
X      XDMCPLIBSRC  LIBSRCXdmcp
X      BDFTOSNFSRC  FONTSRCbdftosnf
X      BDFTOSNFSRC  FONTSRCclientsbdftosnf
X      BDFTOPCFSRC  FONTSRCclientsbdftopcf
X     MKFONTDIRSRC  FONTSRCclientsmkfontdir
X         FSLIBSRC  FONTSRClibfs
X    FONTSERVERSRC  FONTSRCserver
X     EXTENSIONSRC  TOPextensions
X         XILIBSRC  EXTENSIONSRClibxinput
X        PEXLIBSRC  EXTENSIONSRClibPEXlib
X      PHIGSLIBSRC  EXTENSIONSRClibPEX
X
X XConsortium sunLibtmplv 11412 921111 095502 rws Exp 
X
XSHLIBLDFLAGS  assert puretext
XPICFLAGS  fpic
X
X  DEPEXTENSIONLIB 
X     EXTENSIONLIB  lXext
X
X          DEPXLIB  DEPEXTENSIONLIB
X             XLIB  EXTENSIONLIB lX11
X
X        DEPXMULIB  USRLIBDIRlibXmusaSOXMUREV
X       XMULIBONLY  lXmu
X           XMULIB  lXmu
X
X       DEPOLDXLIB 
X          OLDXLIB  loldX
X
X      DEPXTOOLLIB  USRLIBDIRlibXtsaSOXTREV
X         XTOOLLIB  lXt
X
X        DEPXAWLIB  USRLIBDIRlibXawsaSOXAWREV
X           XAWLIB  lXaw
X
X        DEPXILIB 
X           XILIB  lXi
X
X        DEPPEXLIB 
X           PEXLIB  lPEX5
X
X        SOXLIBREV  410
X          SOXTREV  410
X         SOXAWREV  50
X        SOOLDXREV  410
X         SOXMUREV  410
X        SOXEXTREV  410
X      SOXINPUTREV  410
X         SOPEXREV  10
X
X      DEPXAUTHLIB  USRLIBDIRlibXaua
X         XAUTHLIB   lXau
X      DEPXDMCPLIB  USRLIBDIRlibXdmcpa
X         XDMCPLIB   lXdmcp
X
X        DEPPHIGSLIB  USRLIBDIRlibphigsa
X           PHIGSLIB   lphigs
X
X       DEPXBSDLIB  USRLIBDIRlibXbsda
X          XBSDLIB   lXbsd
X
X LINTEXTENSIONLIB  LINTLIBDIRlliblXextln
X         LINTXLIB  LINTLIBDIRlliblX11ln
X          LINTXMU  LINTLIBDIRlliblXmuln
X        LINTXTOOL  LINTLIBDIRlliblXtln
X          LINTXAW  LINTLIBDIRlliblXawln
X           LINTXI  LINTLIBDIRlliblXiln
X          LINTPEX  LINTLIBDIRlliblPEX5ln
X        LINTPHIGS  LINTLIBDIRlliblphigsln
X
X          DEPLIBS  DEPXAWLIB DEPXMULIB DEPXTOOLLIB DEPXLIB
X
X         DEPLIBS1  DEPLIBS
X         DEPLIBS2  DEPLIBS
X         DEPLIBS3  DEPLIBS
X
X 
X Imake rules for building libraries programs scripts and data files
X rules  XConsortium Imakerulesv 1123 910916 201216 rws Exp 
X
X 
X start of Imakefile
X
X Glasgow RX Imakefile
X
X         PROGRAMS  rx
X
Xall PROGRAMS
X
Xinstall safe
X
Xinstall rxpl
X	if  d DESTDIRBINDIR  then set x 
X	else set x MKDIRHIER DESTDIRBINDIR fi
X	INSTALL c INSTBINFLAGS rxpl DESTDIRBINDIRrx
X
Xinstallman rxman
X	if  d DESTDIRMANDIR  then set x 
X	else set x MKDIRHIER DESTDIRMANDIR fi
X	INSTALL c INSTMANFLAGS rxman DESTDIRMANDIRrxMANSUFFIX
X
Xinstall
X	RM BINDIRrxterm
X	LN BINDIRrx BINDIRrxterm
X
Xsafe
X	grep s debug  0 rxpl  false
X
Xshar safe
X	makekit m p
X	perl pi e ssinclairdcsglaacuksinclairdcsglaacuk Part
X
X 
X common rules for all Makefiles  do not edit
X
Xemptyrule
X
Xclean
X	RMCMD 
X
XMakefile
X	if  f Makefile  then set x 
X	RM Makefilebak MV Makefile Makefilebak 
X	else exit 0 fi
X	IMAKECMD DTOPDIRTOP DCURDIRCURRENTDIR
X
Xtags
X	TAGS w ch
X	TAGS xw ch  TAGS
X
Xsaber
X	 load ALLDEFINES SRCS
X
Xosaber
X	 load ALLDEFINES OBJS
X
X 
X empty rules for directories that do not have SUBDIRS  do not edit
X
Xinstall
X	echo install in CURRENTDIR done
X
Xinstallman
X	echo installman in CURRENTDIR done
X
XMakefiles
X
Xincludes
X
X 
X dependencies generated by makedepend
X
ENDOFFILE
if test 10172 ne wc c Makefile then
    echo shar Makefile unpacked with wrong size
fi
 end of Makefile
fi
if test f rxman a 1  c  then 
  echo shar Will not clobber existing file rxman
else
echo shar Extracting rxman 3551 characters
sed sX rxman ENDOFFILE
XTH RX 1 4 March 1993 X Version 11
XSH NAME
Xrxrxtermr  remote command xterm anything execution
XSH SYNOPSIS
XB rx
X
XB l
XI username
X
XI host
X
XI command
X
Xbr
XB rxterm
X
XB l
XI username
X
XI host
X
XIR args 
X
XSH DESCRIPTION
XThe 
XB rx
Xprogram connect to the specified
XI host
Xand executes the specified
XI command
Xin the background returning immediately  To allow the execution
Xof X programs it copies a number of environmental variables to
Xthe remote session  If you omit
XIR command 
Xthen rx will start an xterm on the remote host  The
XB rxterm
Xvarient starts a remote xterm on a host and also passes
XI args
Xto the remote xterm as arguments
XPP
XShell metacharacters which are not quoted are interpreted on the local
Xmachine while quoted metacharacters are interpreted on the remote
Xmachine
XPP
XIf the name of the file from which
XB rx
Xis executed is anything other than rx
XB rx
Xtakes this name stripped on a leading r as the command
Xto run on the remote host using any
XI command
Xparameters as arguments for the remote command
XPP
XIf
XB rx
Xthinks you are using
XB xauth
Xbased X authorisation and you are calling to a offsite host or
Xto a different username it will attempt to copy an authorization
Xkey to the remote account  Otherwise it will try to use
XB xhost1
Xto grant access to the remote host
XSH OPTIONS
XTP
XBI l  username
XUse
XI username
Xas the remote username instead of your local username  In the absence
Xof this option the remote username is the same as your local username
X
XSH ENVIRONMENT
XIf set the values of PATH DISPLAY XENVIRONMENT XAPPLRESDIR
XXFILESEARCHPATH XUSERFILESEARCHPATH OPENWINHOME LDLIBRARYPATH
Xand XAUTHORITY are exported to the remote program unless the
Xremote username is different or the remote host is offsite in which
Xcase only DISPLAY is exported with in all cases any variables named in the
Xvariable RXENV
XPP
XThe DISPLAY variable is tweaked as appropriate to contain as qualified
Xa hostname as is needed
XSH DIAGNOSTICS
XTP
XIB command  dont recognise my name
XB rx
Xcannot decode the name it has been called under  In this case
Xit prints a warning message and continues as normal
XTP
XB rx usage rx l username hostname args
XThis means it could not decode the arguments given to it
XSH AUTHOR
XDuncan Sinclair sinclairdcsglasgowacuk July 1992
Xbr
XOriginally based on a program with the same name from the
XB gwm
Xdistribution  To distinguish this rx from other programs
Xwith similar names you should refer to this program as the
XB Glasgow
XBR rx 
XSH SEE ALSO
XX1 rsh1 xterm1 xauth1 xhost1 gwm1
XSH BUGS
XB Rx
Xmakes a number of assumptions about the relationship between the
Xlocal user and the remote one depending on whether the remote
Xhost is onsite or not and whether an alternative username was used
Xor not
XPP
XIn particular if either the locally used shell or the remotely
Xused shell is the standard Bourne Shell
XB sh1
Xthen strange things are more likely to happen  Especially when 
Xits only one of them
XPP
XSometimes quoting can get messed up
XPP
XIts too easy to fool the smarts in
XB rx
Xto make it believe something that is not true and fail because of it
XPP
XWhen
XB rx
Xuses
XB xhost
Xto grant access the
XB xhost
Xcommand may fail silently
XPP
XIf
XB rx
Xtries to send to large a command to the remote machine it will
Xlikely fail with a parse error from csh  If this happens you
Xwill probably have to reduce the size of the exported environment
ENDOFFILE
if test 3551 ne wc c rxman then
    echo shar rxman unpacked with wrong size
fi
 end of rxman
fi
if test f rxpl a 1  c  then 
  echo shar Will not clobber existing file rxpl
else
echo shar Extracting rxpl 9028 characters
sed sX rxpl ENDOFFILE
X usrlocalbinperl
X CONFIG change the line above to point to your copy of perl
X
X Glasgow RX  version 317
X
X Copyright 1992 Duncan Sinclair sinclairdcsglaacuk
X
X Last Modified  Early April 1993
X
X Distribution limited as per the usual MIT copyright
X
X remote execution of X programs  Based on a script in an old version of gwm
X
X To install put rx in your bin and make rxterm a link to it
X  Some configuration will be necessary see CONFIG comments
X
X More and more this is less and less like the original
X
X Major hacked to work for ourmy set up and also partly
X  rewritten to work with sh rather than ksh
X
X Maybe Ill turn this into our first zsh script
X
X Looks like it turned into a perl script at some point  big improvement
X
X This code tries to be intelligent in the way it works  This means there
X  are tons of implicit assumptions about the environment it is run in
X  These assumptions are all valid on the machines I use and in my
X  environment  At the same time I try to make as few assumptions as possible
X  about the remote machine  Heres a list of all the more tricky ones
X  That the remote machine has csh  Linux
X  That RSHELL  binksh  remote shell  binksh  Make same
X  If remote shell  sh that PATH is compatible  Use csh etc
X  I pass a cookie to the remote machine if need be but does it
X    know what to do with a cookie eat it
X  There must be others
X
X Why am I using csh to run the remote commands  Simply because it doesnt
X  interact badly with rsh and hang waiting for a file descriptor to
X  be closed  Id rather use zsh or bash or even perl but they are not
X  as universal as csh
X
X
Xrequire statpl
X
X What we called
X
Xargv0  0 
Xargv0  s 
X
X CONFIG
X Change these variables to be your domain name and a pattern that
X  will match all variations on your domain name  You must include
X  those leading dots If your hostname includes your domain see
X  the code further down marked XXX
X
XDOM   dcsglaacuk 
XDOMPAT  dcsglasgowacuk 
X
X CONFIG
X Change this to your value of BINDIR or set the variable to  if
X  you think your users are smarter than that
X
XXPATHS  usrX11bin 
X
X CONFIG
X Make this the name of your remote shell command
X
XRSH  rsh 
X
X end of CONFIG
X
X Some variables well no doubt use sometime
X
Xusage  argv0 usage argv0 l username hostname argsn 
XRSHELL  getpwuid8  binsh 
XHOME  ENVHOME  getpwuid7 
XXAUTH  ENVXAUTHORITY  HOME  Xauthority 
XLOGF  rxlog 
XSTUFF   
Xdebug  0 
X
X Before anything else close stdin  This might stop rx hanging
X  due to rsh weirdness
X
XcloseSTDIN
X
X do a l flag
X
Xif ARGV0 eq l 
X  shift 
X  User  ARGV0  die usage 
X  LUser  lUser 
X  shift 
X
X
X Pick a host any host
X
XMACH  ARGV0  die usage 
Xshift 
X
X Things to think about for the remote machine
X
XMACH  sDOMPAT 
XOffSite  MACH   
X
X Where am I  Seems we cant trust the dumb user to set HOSTNAME right
X
XHOSTNAMEENVHOSTNAME  hostname 		 Current Host
XHOSTNAMEhostname 					 Current Host
XHOSTNAME  sn 
X
X  If all your hostnames include your domain comment out the next line
X
Xif  OffSite   HOSTNAME  HOSTNAME  DOM  	 XXX
X
X Now we know where we are and they are are they different
X
XDiff  HOSTNAME ne MACH 
X
X What is the display going to be
X  Danger  Heavy Regular expressions follow
X This needs to be rewritten to be modular and can so be extended to
X  support resetting host to unix as required
X
XDISPLAY  ENVDISPLAY  00 
XDISPLAY  sDOMPAT 
XDISPLAY  sunixddHOSTNAME2 if Diff 
XDISPLAY  sdd1DOM2 if OffSite 
XENVDISPLAY  DISPLAY 
X
X Here comes the hard bit in sh  Quote our args
X Also have to quote quotes  To cope with csh braindamage
X  quotes are quoted thus   
X So for an arg foobar we get foobar
X
Xforeach ARGV 
X  sg 
X  s1 
X
X
X So what we doing
X
XPROG 
X  if argv0 eq rx  last PROG  
X  if argv0 eq rxterm 
X    unshiftARGVls if Diff 
X    unshiftARGVxtermlsnMACH 
X    last PROG 
X  
X  if argv0  r  unshiftARGV1  last PROG  
X  warn argv0 dont recognise my name 
X
X
X If nothing else become an rxterm
X
Xif ARGV  0 
X  unshiftARGVls if Diff 
X  unshiftARGVxtermlsnMACH 
X
X
X Some special considerations if we are not ourselves on the other side
X
Xif OffSite  User 
X  
X   We want to pass a cookie here
X  
X  if e XAUTH 
X    
X     This is going to be unsecure as the cookie will appear in a number
X      of command line args  But at least itll work
X     This will need enhanced if we ever fix the code above to
X      set DISPLAY to 00 when we return to the server
X    
X    CooKie  PATHPATHXPATHS xauth list DISPLAY 
X    chopCooKie 
X    CooKs  split CooKie 
X    shiftCooKs 
X    unshiftSTUFFxauthaddDISPLAYCooKs if CooKs  2 
X   else 
X    
X     Yuk  What a crock  I hate doing this
X    
X    systemxhost MACH devnull 2devnull if Diff 
X  
X  
X   We really only want to pass a value for DISPLAY
X  
X  VARSDISPLAY split ENVRXENV 
X else 
X  
X   Some variables we wish to export
X  
X  VARS
X    DISPLAY
X    XENVIRONMENT
X    XFILESEARCHPATH
X    XUSERFILESEARCHPATH
X    XAPPLRESDIR
X    OPENWINHOME
X    LDLIBRARYPATH
X     MANPATH		 for rxman and bourne shell users
X    XAUTHORITY
X    split ENVRXENV
X     
X  
X   Braindead bourne shell needs to be given a PATH
X   We would rather not pass the current PATH because it might not work
X    on the destination machine  Id rather it was set by the users
X    remote shell during the rsh
X   Fortunately all my X programs are in an arch independant place and
X    so it shouldnt cos a problem locally
X   We check against RSHELL because they might be running another shell
X    differant from their login shell  I know sounds weird but its too
X    common round here
X   Ive also included ksh in the braindamage cos I cant see an easy way
X    to pass throught ENVENV without it being too late We only have
X    one person who has ksh as a login shell anyway
X   Oh yeah we are assuming that if its bourne shell here then its
X    bourne shell there  Much more important than this is that it it ISNT
X    bourne shell here it better not be bourne shell there
X  
X  if RSHELL  mksh  pushVARSPATH 
X
X
X Validate PWD routine
X
Xsub validatepwd 
X  localpwdstats dotstats
X  localpwd  0
X
X  unless definedpwd           return undef  
X  unless dotstats  stat   return undef  
X  unless pwdstats  statpwd  return undef  
X  if pwdstatsSTDEV  dotstatsSTDEV 
X      pwdstatsSTINO  dotstatsSTINO  return undef  
X  pwd
X
X
X Try and find a nice valid pwd
X
XPRESENT 
X  if PWD  ENVPWD 
X    FOOPWD  PWD 
X    FOOPWD  stmpmntexport2 
X    PWD  validatepwdFOOPWD  validatepwdPWD 
X   
X  unless PWD 
X    chopPWD  pwd 
X    FOOPWD  PWD 
X    FOOPWD  stmpmntexport2 
X    PWD  validatepwdFOOPWD  validatepwdPWD  HOME
X  
X
XPWD  s1 
X
X Try to find somewhere nice to live on the other side
X
Xunless OffSite 
X  unshiftSTUFFtestdPWDcdPWD
X
X
X Start building the full command
X
Xforeach var VARS 
X  val  ENVvar 
X     unshiftSTUFFsetenvvarval 
X
X
X Some commands to do on the other side
X
XunshiftSTUFFsetnonomatch	 only if we are using csh
X
X Build the remote command
X
XREMOTEumask 077  join STUFFARGVdevnull LOGF  
XREMOTE  sg 
XREMOTE    REMOTE   
X
X Build the arg list for the exec
X
XCOMMRSHLUserMACHcshfcREMOTE 
X
X Do it
X
Xif debug 
X  print COMMn 
X else 
X  exec COMM 
X
X
X Rsh doesnt return any indication of how it went over
X on the other side but thats OK cos we aint going to
X wait around to see what happened
X
Xexit 0 
X
X tHe ENd
ENDOFFILE
if test 9028 ne wc c rxpl then
    echo shar rxpl unpacked with wrong size
fi
chmod x rxpl
 end of rxpl
fi
echo shar End of archive 1 of 1
cp devnull ark1isdone
MISSING
for I in 1  do
    if test  f arkIisdone  then
	MISSINGMISSING I
    fi
done
if test MISSING    then
    echo You have the archive
    rm f ark19isdone
else
    echo You still need to unpack the following archives
    echo          MISSING
fi
  End of shell archive
exit 0


 
    Duncan Sinclair    sinclairdcsglaacuk    sinclairukacgladcs
        Would the real UNIX Operating System please stand up  
