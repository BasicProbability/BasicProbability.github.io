From rbrandusasocsocmil Raymond S Brand
Subject Re Clipper considered harmful

In article 1993Apr2416012117189ulyssesattcom smbresearchattcom Steven Bellovin writes

 There are three issues with Clipper  The first is whether or not the
 architecture of the whole scheme is capable of working  My answer
 with one significant exception is yes  I really do think that NSA and
 NIST have designed this scheme about as well as can be assuming that
 their real objectives are as stated to permit wiretapping under
 certain carefullycontrolled circumstances with a minimum risk of
 abuse  The exception is that U exists outside of the chip on a
 programming diskette  Thats seriously wrong  U1 and U2 should be
 loaded onto the chip separately  To those who disagree and I dont
 claim my answer is obvious though I found my own reasoning
 sufficiently persuasive that I was forced to rewrite the Conclusions
 section of my technical analysis paper  I had originally blasted the
 scheme I issue this invitation  assume that you were charged with
 implementing such a system with complete regard for civil rights and
 due process  What would you do differently  In answering this
 question please accept NSAs fundamental assumptions  that both
 strong cryptography against outsiders and the ability to wiretap
 some domestic users is necessary  If you feel it necessary to
 challenge those assumptions do it in the context of the last issue I
 present below  Right here Im discussing just the technical
 aspects  And no I dont by any means claim that just because
 something can be done it should be

OK Steve heres a sketch of an alternative that I believe addresses
most of the objections to the Clipper scheme

Notation
		concatenation
		exclusive or
	EMK	message M encrypted by key K
	DMK	message M decrypted by key K
	HM	hash digestsignature of message M

Important Values
	U0X		local chip unit key from escrow agency X
	U1X		remote chip unit key from escrow agency X
	N0		serial number of the local chip
	N1		serial number of the remote chip
	A		number of escrow agencies
	K0K1	session keys agreed upon external to this protocol
	F		family key need not be secret

Protocol
	Choose K01K0A such that K0  K01K0A
	Remote chip does same for K1K11K1A

	Compute the following

		L01  EK01 U01
		
		L0A  EK0A U0A

		L0  N0  EN0  L01    L0A F

		Remote chip does the same for L11L1AL1

	Send L0 to remote chip and receive L1 from remote chip

	Compute

		KE0  HK0  N0  L01    L0A
			 K1  DL1 F

		KD0  HK1  DL1 F
			 K0  N0  L01    L0A

		Note that DL1 F  N1  L11    L1A

		Remote chip does the same for KE1 and KD1

	User data is encrypted decrypted with keys KE0 KE1
		KD0 KD1

Assumptions
	No trap doors in E D and H H is not invertible

	Algorithms for E D and H are secret Otherwise a software
	implementation bogus chip could communicate with a real chip

	The chip only supports the following operation

		1  Return N0
		2  Load K0x
		3  Return EK0x U0x
		4  Return EN0  L01    L0A F
		5  Given EN1  L11    L1A F
			return N1L11L1A
		6  Load K1
		7  Given EN1  L11    L1A F
			compute KE0 KD0
		8  Given M return EM KE0
		9  Given M return DM KD0

	Anything programmed into the chip can be determined by destroying
	the chip U1UAFN0

	U1UA can not be determined except by destroying the chip
	Unfortunately this may not be true in reality I suppose its
	possible to determine how a chip has been programmed with a
	sophisticatedsp xray machine to look for blown fuses

	The Us are programmed independantly by the escrow agencies

Notes
	For tapping escrow agency Y is given N0 EK0Y U0Y N1
	EK1Y U1Y and returns K0Y K1Y

	LEAs must contact all escrow agencies with the serial numbers from
	both chips and the encrypted partial keys This allows the agencies
	to record that both chips were tapped

	LEAs only get the session key not the key to all conversations
	of a particular chip This precludes realtime decrypting of a
	conversation but that isnt one of the STATED requirements

Observation
	In order for any secure by tapable communication scheme to work
	the active parts need to share a secret And if this secret is
	revealed communications by those that know the secret can be made
	untapable Obvious candidates are the cryptographic algorithm
	and the master family key Relative size and complexity suggests
	that the key can be obtained from a silicon implementation of the
	scheme a LOT easier and faster than the algorithm


						rsbx


Raymond S Brand					rbrandusasocsocmil

